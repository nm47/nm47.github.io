<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.2ecf4fe993eedae9de64.css" id="gatsby-global-css">@import url(https://fonts.googleapis.com/css?family=Heebo&display=swap);code[class*=language-],pre[class*=language-]{color:#000;background:none;text-shadow:0 1px #fff;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}pre[class*=language-].line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}pre[class*=language-].line-numbers>code{position:relative;white-space:inherit}.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:0;font-size:100%;left:-3.8em;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-ms-user-select:none;user-select:none}.line-numbers-rows>span{display:block;counter-increment:linenumber}.line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.link-module--wrapper--2dAz0{margin-bottom:30px}.link-module--linkTitle--3VUWq{border-bottom:1px solid #3997dc;color:#32404b;display:inline-block;font-size:20px;font-weight:700;margin-bottom:10px;text-decoration:none}.link-module--linkTitle--3VUWq:hover{color:#3997dc}.link-module--title--3H5Ml{color:#32404b;display:inline-block;font-size:20px;font-weight:700;margin-bottom:10px}.link-module--desc--2JcNe{font-size:16px}.socials-module--list--nQjwE{margin:15px 0 0;padding:0}.socials-module--item--2qCBJ{display:inline-block;list-style:none;margin-right:20px}.socials-module--link--m0nMJ{color:#787a82;text-decoration:none}.socials-module--link--m0nMJ:hover{color:#3997dc}.header-module--headerWrapper--15qHx{display:flex;margin-bottom:90px}.header-module--profileWrapper--17Lox{position:relative}.header-module--profilePicture--1aaYx{border-radius:50%;overflow:hidden;width:185px}.header-module--profileContent--3G8DP{margin:10px 0 0 50px}.header-module--profileContent--3G8DP h1{color:#1f2933;font-size:45px;letter-spacing:2px;margin:0}.header-module--profileContent--3G8DP h2{font-size:20px;font-weight:400;margin:0 0 30px}@media only screen and (max-width:600px){.header-module--profilePicture--1aaYx{width:150px}}@media only screen and (max-width:768px){.header-module--headerWrapper--15qHx{display:block}.header-module--profileWrapper--17Lox{display:block;width:100%}.header-module--profileContent--3G8DP{display:block;margin:25px 0 0;width:100%}}.container-module--wrapper--_zFcw{max-width:1200px;padding:100px;position:relative;width:100%;text-align:left;display:inline-block}@media only screen and (max-width:768px){.container-module--wrapper--_zFcw{padding:25px}}.layout-module--blobMain--3VKey{position:fixed;top:-150px;right:-700px;z-index:-1}.layout-module--blobMain--3VKey svg{width:1300px;height:1300px;opacity:.5}.layout-module--blobSecondary--1ryDs{position:fixed;top:-250px;right:-750px;z-index:-1}.layout-module--blobSecondary--1ryDs svg{width:1500px;opacity:.1;height:1500px}@media only screen and (max-width:1200px){.layout-module--blobMain--3VKey{opacity:.3}.layout-module--blobSecondary--1ryDs{opacity:.5}}@media only screen and (max-width:768px){.layout-module--blobMain--3VKey{display:none}.layout-module--blobSecondary--1ryDs{opacity:.5}}

/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */h1{font-size:2em}.section-module--wrapper--1PJu9{display:flex;flex-direction:row;margin-bottom:50px}.section-module--left--4Dzzx{width:300px}.section-module--right--3Zh5J{flex:1 1;max-width:700px}.section-module--title--3LB2K{color:#787a82;font-size:14px;font-weight:400;margin:0 0 30px;letter-spacing:3px;text-transform:uppercase}@media only screen and (max-width:768px){.section-module--wrapper--1PJu9{display:block}.section-module--left--4Dzzx,.section-module--right--3Zh5J{display:block;width:100%}}.blogpost-module--blobMain--1DUNn{position:fixed;top:-150px;right:-700px;z-index:-1}.blogpost-module--blobMain--1DUNn svg{width:1300px;height:1300px;opacity:.2}@media only screen and (max-width:1200px){.blogpost-module--blobMain--1DUNn{display:none}}@media only screen and (max-width:768px){.blogpost-module--blobMain--1DUNn{display:none}}

/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15}body{margin:0}main{display:block}h1{font-size:2.5em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}[hidden],template{display:none}*,:after,:before{box-sizing:inherit}html{background:#fff;color:#52606d;font-size:15px;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;box-sizing:border-box}body{font-family:Heebo,sans-serif;font-size:1em;line-height:1.25;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}img{max-width:100%;margin:0}p{color:#3b3942;font-size:18px;line-height:1.5;margin:0 0 30px}.hr{box-sizing:content-box;width:25%;border:1px solid #e2e8f0;margin:0}</style><meta name="generator" content="Gatsby 2.27.0"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><title data-react-helmet="true">Building an RF Socket Controller | Portfolio</title><meta data-react-helmet="true" name="description" content="Senior in Computer Science at the University of Houston"/><meta data-react-helmet="true" property="og:title" content="Building an RF Socket Controller"/><meta data-react-helmet="true" property="og:image" content="https://nm47.github.io/static/social-4a9773549091c227cd2eb82ccd9c5e3a.jpg"/><meta data-react-helmet="true" property="og:description" content="Senior in Computer Science at the University of Houston"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="@NielsMoeller"/><meta data-react-helmet="true" name="twitter:title" content="Building an RF Socket Controller"/><meta data-react-helmet="true" name="twitter:description" content="Senior in Computer Science at the University of Houston"/><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><link rel="icon" href="/favicon-32x32.png?v=4a9773549091c227cd2eb82ccd9c5e3a" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link as="script" rel="preload" href="/webpack-runtime-891aae49d9d06a9f2ea5.js"/><link as="script" rel="preload" href="/framework-8e528b732ab2eaadb7b7.js"/><link as="script" rel="preload" href="/app-736aacbb0dfdef285c7e.js"/><link as="script" rel="preload" href="/styles-407fe62976dc5310c43e.js"/><link as="script" rel="preload" href="/commons-c42941a1aba60f60c136.js"/><link as="script" rel="preload" href="/component---src-templates-blog-template-js-a1a1e50a0ee0dec12cba.js"/><link as="fetch" rel="preload" href="/page-data/blog/RFSocket/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/63159454.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div><div class="container-module--wrapper--_zFcw"><h1 class="mt-16 text-4xl text-gray-900 font-bold">Building an RF Socket Controller</h1><p class="text-gray-600 font-light">Posted on <!-- -->January 20, 2015</p><div class="blog-post-content"><p>For Christmas this year we got radio controlled sockets for our christmas lights, because all the lights are plugged in on opposite sides of the house as well as outside. When christmas ended I decided to use these sockets for the T.V. and lamps. It was pretty annoying having to use the remote though, so I had the idea to build a simple website to automate the house.</p>
<h2>The Raspberry Pi</h2>
<p>I started with a raspberry pi, and 433Mhz RF emitter and receiver modules, but the obvious problem was that I had nothing to send to the sockets. I had seen this done with other types of sockets, but I couldn't find any available protocols online for the sockets that we had, so I decided to record them myself.</p>
<h2>The Receiver Setup</h2>
<p>To record the signal, I used a raspberry pi to provide 5v for the RF receiver, and simply sent the recieved signal into the line-in jack of my computer. The only complication was that the line-in expected only 1.23v, while my rf receiver outputs 5v, so I made a simple voltage diveder (schematic pictured) to drop the voltage to around 1v which worked fine without blowing out my sound card. I used resistors i had on hand that were 4700 ohm, and 1000 ohm.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 350px; margin-left:0"
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/913e0c690643bd1377231188c08a59ab/19034/voltage-divider.jpg"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 85.50000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAARABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe9NQKEDQP/EABgQAAMBAQAAAAAAAAAAAAAAAAABEBEx/9oACAEBAAEFAsEaouRT/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAFBABAAAAAAAAAAAAAAAAAAAAMP/aAAgBAQAGPwIf/8QAHBAAAQMFAAAAAAAAAAAAAAAAAQAQIREgMUFx/9oACAEBAAE/IeiiiTKqbFtg3//aAAwDAQACAAMAAAAQ48gA/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPxAf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPxAf/8QAHhAAAgICAgMAAAAAAAAAAAAAAREhMQAQQbFRYYH/2gAIAQEAAT8QCBC/kvK4pEX7wVDKIOgSNyZ+4h413nvX/9k='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="NO IMAGE ):"
        title="NO IMAGE ):"
        src="/static/913e0c690643bd1377231188c08a59ab/19034/voltage-divider.jpg"
        srcset="/static/913e0c690643bd1377231188c08a59ab/8f721/voltage-divider.jpg 200w,
/static/913e0c690643bd1377231188c08a59ab/19034/voltage-divider.jpg 350w"
        sizes="(max-width: 350px) 100vw, 350px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>The audio was then recorded with audacity, where I manually converted the signal to ones and zeroes. </p>
<h2>The Emitter</h2>
<p>This was the easiest part, after recording and transcribing all of the signals, all I had to do was write a little script to send them. I found that I had to send each code twice to reliably toggle each socket, and it seems that like original remote was doing that itself as well. I suppose it's just more reliable to send everything twice.</p>
<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">SendCode</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> szCode<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   timespec sleeptime<span class="token punctuation">;</span>
   timespec remtime<span class="token punctuation">;</span>
   <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> delay<span class="token punctuation">;</span>
   delay <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
     <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> iSend <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span> iSend <span class="token operator">&lt;</span> <span class="token number">10</span> <span class="token punctuation">;</span> iSend<span class="token operator">++</span><span class="token punctuation">)</span>
     <span class="token punctuation">{</span>
      sleeptime<span class="token punctuation">.</span>tv_sec <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      sleeptime<span class="token punctuation">.</span>tv_nsec <span class="token operator">=</span> delay <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">;</span> <span class="token comment">// value obtained by trial and error to match transmitter</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span>szCode<span class="token punctuation">)</span> <span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>szCode<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'1'</span><span class="token punctuation">)</span>
          <span class="token punctuation">{</span>
              GPIO_SET <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">&lt;&lt;</span><span class="token number">7</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">else</span>
          <span class="token punctuation">{</span>
              GPIO_CLR <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">&lt;&lt;</span><span class="token number">7</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token function">nanosleep</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>sleeptime<span class="token punctuation">,</span><span class="token operator">&amp;</span>remtime<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      sleeptime<span class="token punctuation">.</span>tv_nsec <span class="token operator">=</span> <span class="token number">10000000</span><span class="token punctuation">;</span> <span class="token comment">//10ms</span>
      <span class="token function">nanosleep</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>sleeptime<span class="token punctuation">,</span><span class="token operator">&amp;</span>remtime<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div></div><hr class="hr"/></div><div class="blogpost-module--blobMain--1DUNn"><svg width="504" height="784" fill="none" viewBox="0 0 604 784"><defs><pattern id="5d0dd344-b041-4d26-bec4-8d33ea57ec9b" x="0" y="0" width="20" height="20" patternUnits="userSpaceOnUse"><rect x="0" y="0" width="4" height="4" class="text-gray-200" fill="#3586ea"></rect></pattern></defs><rect width="404" height="784" fill="url(#5d0dd344-b041-4d26-bec4-8d33ea57ec9b)"></rect></svg></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-HE902F5X68"></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){window.dataLayer && window.dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-HE902F5X68', {"send_page_view":false});
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/RFSocket";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-78cdc6a84a6e659c51c0.js"],"app":["/app-736aacbb0dfdef285c7e.js"],"component---src-pages-404-js":["/component---src-pages-404-js-12a6c4c491926d618fcd.js"],"component---src-pages-index-js":["/component---src-pages-index-js-1e471973dd657495c6ec.js"],"component---src-pages-page-2-js":["/component---src-pages-page-2-js-b2901625d65b5618d6f8.js"],"component---src-templates-blog-template-js":["/component---src-templates-blog-template-js-a1a1e50a0ee0dec12cba.js"]};/*]]>*/</script><script src="/polyfill-78cdc6a84a6e659c51c0.js" nomodule=""></script><script src="/component---src-templates-blog-template-js-a1a1e50a0ee0dec12cba.js" async=""></script><script src="/commons-c42941a1aba60f60c136.js" async=""></script><script src="/styles-407fe62976dc5310c43e.js" async=""></script><script src="/app-736aacbb0dfdef285c7e.js" async=""></script><script src="/framework-8e528b732ab2eaadb7b7.js" async=""></script><script src="/webpack-runtime-891aae49d9d06a9f2ea5.js" async=""></script></body></html>