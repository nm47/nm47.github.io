{"componentChunkName":"component---src-templates-blog-template-js","path":"/blog/RFSocket","result":{"data":{"markdownRemark":{"html":"<p>For Christmas this year we got radio controlled sockets for our christmas lights, because all the lights are plugged in on opposite sides of the house as well as outside. When christmas ended I decided to use these sockets for the T.V. and lamps. It was pretty annoying having to use the remote though, so I had the idea to build a simple website to automate the house.</p>\n<h2>The Raspberry Pi</h2>\n<p>I started with a raspberry pi, and 433Mhz RF emitter and receiver modules, but the obvious problem was that I had nothing to send to the sockets. I had seen this done with other types of sockets, but I couldn't find any available protocols online for the sockets that we had, so I decided to record them myself.</p>\n<h2>The Receiver Setup</h2>\n<p>To record the signal, I planned to use the raspberry pi simply to provide 5v for the RF receiver, and simply send the recieved signal into the line-in jack of my computer. Sadly, the line-in expected only 1.23v, while my rf receiver outputs 5v. I made a simple voltage diveder (schematic pictured) to drop the voltage to around 1v which worked fine without blowing out my sound card. I used resistors i had on hand that were 4700 ohm, and 1000 ohm.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 350px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/portfolio/static/913e0c690643bd1377231188c08a59ab/70ebb/voltage-divider.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 85.50000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAARABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe9NQKLkNA//xAAXEAADAQAAAAAAAAAAAAAAAAAAARAR/9oACAEBAAEFAsEaoqp//8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAFhAAAwAAAAAAAAAAAAAAAAAAECAx/9oACAEBAAY/AhX/AP/EABsQAAEEAwAAAAAAAAAAAAAAAAEAECExYXGB/9oACAEBAAE/IdiiiTKwGq9Ot//aAAwDAQACAAMAAAAQ48AA/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPxAf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPxAf/8QAHhAAAgEEAwEAAAAAAAAAAAAAARExABAhsUFRYXH/2gAIAQEAAT8QCBc7yXUcSEifaBmiLE2BK3k7pDq0/wBbt//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"NO IMAGE ):\"\n        title=\"NO IMAGE ):\"\n        src=\"/portfolio/static/913e0c690643bd1377231188c08a59ab/70ebb/voltage-divider.jpg\"\n        srcset=\"/portfolio/static/913e0c690643bd1377231188c08a59ab/e07e9/voltage-divider.jpg 200w,\n/portfolio/static/913e0c690643bd1377231188c08a59ab/70ebb/voltage-divider.jpg 350w\"\n        sizes=\"(max-width: 350px) 100vw, 350px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>The audio was then recorded with audacity, where I manually converted the signal to ones and zeroes. </p>\n<h2>The Emitter</h2>\n<p>This was the easiest part, after recording and transcribing all of the signals, all I had to do was write a little script to send them</p>\n<pre><code class=\"language-python\">void SendCode(char* szCode)\n{\n   timespec sleeptime;\n   timespec remtime;\n   unsigned long long delay;\n   delay = 100;\n     for (int iSend = 0 ; iSend &#x3C; 10 ; iSend++)\n     {\n      sleeptime.tv_sec = 0;\n      sleeptime.tv_nsec = delay * 1000; // value obtained by trial and error to match transmitter\n      for (int i = 0 ; i &#x3C; strlen(szCode) ; i++)\n      {\n          if (szCode[i] == '1')\n          {\n              GPIO_SET = 1&#x3C;&#x3C;7;\n          }\n          else\n          {\n              GPIO_CLR = 1&#x3C;&#x3C;7;\n          }\n          nanosleep(&#x26;sleeptime,&#x26;remtime);\n      }\n      sleeptime.tv_nsec = 10000000; //10ms\n      nanosleep(&#x26;sleeptime,&#x26;remtime);\n     }\n}\n</code></pre>","frontmatter":{"date":"January 20, 2015","path":"/blog/RFSocket","title":"Building an RF Socket Controller"}}},"pageContext":{}}}